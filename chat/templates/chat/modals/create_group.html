<div id="createGroupModal" class="modal-overlay" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Create Group</h3>
      <button class="btn-icon" onclick="document.getElementById('createGroupModal').style.display='none'">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <form method="POST" action="{% url 'chat:create_group' %}">
      {% csrf_token %}
      <div class="form-group">
        <label class="form-label">Group Name</label>
        <input type="text" name="group_name" class="form-control" placeholder="Enter group name" required>
      </div>
      <div class="form-group">
        <label class="form-label">Select Friends</label>
        <div class="friends-list-select custom-scrollbar">
          {% for friend in friends %}
            <label class="friend-select-item">
              <input type="checkbox" name="users" value="{{ friend.id }}">
              <div class="friend-info">
                {% if friend.avatar %}
                  <img src="{{ friend.avatar.url }}" class="user-avatar-small">
                {% else %}
                  <div class="user-avatar-placeholder-small">{{ friend.username|slice:":1"|upper }}</div>
                {% endif %}
                <span class="friend-name">{{ friend.full_name|default:friend.username }}</span>
              </div>
            </label>
          {% empty %}
            <p class="text-muted">You need to add friends before creating a group.</p>
          {% endfor %}
        </div>
      </div>
      <button type="submit" class="btn btn-primary btn-block" {% if not friends %}disabled{% endif %}>Create Group</button>
    </form>
  </div>
</div>

<style>
.friends-list-select {
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 10px;
    margin-top: 8px;
}

.friend-select-item {
    display: flex;
    align-items: center;
    padding: 8px;
    cursor: pointer;
    border-radius: 6px;
    transition: background 0.2s;
}

.friend-select-item:hover {
    background: var(--hover-bg);
}

.friend-select-item input {
    margin-right: 12px;
    width: 16px;
    height: 16px;
}

.friend-info {
    display: flex;
    align-items: center;
    gap: 10px;
}
</style>
